{
    // 1. DECLARANDO O PROCEDIMENTO DENTRO DE UM BLOCO
    proc analisarFuncionarios (string arquivo_csv, string nome_dataframe) {
        LOAD arquivo_csv AS temp_df;
        MEAN temp_df.salario AS media_salarial;
        MEDIAN temp_df.salario AS mediana_salarial;
        STD temp_df.idade AS desvio_idade;
        FILTER temp_df WHERE idade > 30 AS seniores;
        MEAN seniores.salario AS media_seniores;
        SHOW media_salarial;
        SHOW media_seniores;
        {
            var nome_dataframe = temp_df;
        }
    };
}

// 2. Executar (chamar) o PROCEDIMENTO FORA DO BLOCO
call analisarFuncionarios("Testes/csvs/funcionarios_completo.csv", "func");
call analisarFuncionarios("funcionarios_filial_2.csv", "func_filial_2");